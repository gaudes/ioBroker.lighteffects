{
  "version": 3,
  "sources": ["../../src/modules/global-helper.ts"],
  "sourcesContent": ["import * as SentryObj from \"@sentry/types\";\n\nexport class GlobalHelper {\n\tAdapter: ioBroker.Adapter;\n\tSentry?: SentryObj.Hub;\n\n\tconstructor(adapterInstance: ioBroker.Adapter) {\n\t\tthis.Adapter = adapterInstance;\n\t\t// Init Sentry\n\t\tif (this.Adapter.supportsFeature && this.Adapter.supportsFeature(\"PLUGINS\")) {\n\t\t\tconst sentryInstance: ioBroker.Plugin | null = this.Adapter.getPluginInstance(\"sentry\");\n\t\t\tif (sentryInstance) {\n\t\t\t\tthis.Sentry = sentryInstance.getSentryObject();\n\t\t\t}\n\t\t}\n\t}\n\n\t//#region Helper Function ReportingError\n\t/**\n\t * Function for global error reporting\n\t * @param {Object} Err Error-Object\n\t * @param {string} FriendlyError Error message for user\n\t * @param {string} NameFunction Name of the function where error occured\n\t * @param {string} NameAction Name of the subfunction where error occured\n\t * @param {string} Info Contextual information\n\t * @param {boolean} ReportSentry Report error to sentry, default true\n\t */\n\tasync ReportingError(\n\t\tErr: Error | null,\n\t\tFriendlyError: string,\n\t\tNameFunction: string,\n\t\tNameAction = \"\",\n\t\tInfo = \"\",\n\t\tReportSentry = true,\n\t): Promise<void> {\n\t\ttry {\n\t\t\tlet sErrMsg = `Error occured: ${FriendlyError} in ${NameFunction}`;\n\t\t\tif (NameAction !== \"\") sErrMsg = sErrMsg + `(${NameAction})`;\n\t\t\tif (Err !== null) sErrMsg = sErrMsg + ` [${Err}] [${Info}]`;\n\t\t\tthis.Adapter.log.error(sErrMsg);\n\t\t} catch (e) {\n\t\t\tthis.Adapter.log.error(`Exception in ErrorReporting [${e}]`);\n\t\t}\n\t\t// Sentry reporting\n\t\ttry {\n\t\t\tif (this.Sentry && this.Adapter.config.sentry_disable === false && ReportSentry === true) {\n\t\t\t\tthis.Sentry &&\n\t\t\t\t\tthis.Sentry.withScope((scope) => {\n\t\t\t\t\t\tscope.setLevel(\"error\" as SentryObj.SeverityLevel);\n\t\t\t\t\t\tscope.setExtra(\"NameFunction\", NameFunction);\n\t\t\t\t\t\tscope.setExtra(\"NameAction\", NameAction);\n\t\t\t\t\t\tif (Info) {\n\t\t\t\t\t\t\tscope.setExtra(\"Info\", Info);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//scope.setExtra(\"Config\", this.config);\n\t\t\t\t\t\tif (this.Sentry) {\n\t\t\t\t\t\t\tthis.Sentry.captureException(Err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tthis.Adapter.log.error(`Exception in ErrorReporting Sentry [${e}]`);\n\t\t}\n\t}\n\t//#endregion\n\n\t//#region Helper Function ReportingInfo\n\t/**\n\t * Function for global information reporting\n\t * @param {\"Info\"|\"Debug\"|\"Warn\"} Level Level for ioBroker Logging\n\t * @param {string} Category Category of information\n\t * @param {string} Message Message\n\t * @param {{[Key: string]: any}|undefined} Data Contextual data information\n\t */\n\tReportingInfo(\n\t\tLevel: \"Info\" | \"Debug\" | \"Warn\",\n\t\tCategory: string,\n\t\tMessage: string,\n\t\tData?: { [Key: string]: any } | undefined,\n\t): void {\n\t\tlet iobMessage = Message;\n\t\tif (this.Adapter.log.level === \"debug\" || this.Adapter.log.level === \"silly\") {\n\t\t\tiobMessage = `[${Category}] ${Message}`;\n\t\t}\n\t\tswitch (Level) {\n\t\t\tcase \"Warn\":\n\t\t\t\tthis.Adapter.log.warn(iobMessage);\n\t\t\t\tbreak;\n\t\t\tcase \"Debug\":\n\t\t\t\tthis.Adapter.log.debug(iobMessage);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.Adapter.log.info(iobMessage);\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.Sentry?.addBreadcrumb({\n\t\t\tcategory: Category,\n\t\t\tmessage: Message,\n\t\t\t//level: Level as SentryObj.Severity,\n\t\t\tdata: Data,\n\t\t});\n\t}\n\t//#endregion\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEO,MAAM,aAAa;AAAA,EACzB;AAAA,EACA;AAAA,EAEA,YAAY,iBAAmC;AAC9C,SAAK,UAAU;AAEf,QAAI,KAAK,QAAQ,mBAAmB,KAAK,QAAQ,gBAAgB,SAAS,GAAG;AAC5E,YAAM,iBAAyC,KAAK,QAAQ,kBAAkB,QAAQ;AACtF,UAAI,gBAAgB;AACnB,aAAK,SAAS,eAAe,gBAAgB;AAAA,MAC9C;AAAA,IACD;AAAA,EACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,MAAM,eACL,KACA,eACA,cACA,aAAa,IACb,OAAO,IACP,eAAe,MACC;AAChB,QAAI;AACH,UAAI,UAAU,kBAAkB,aAAa,OAAO,YAAY;AAChE,UAAI,eAAe;AAAI,kBAAU,UAAU,IAAI,UAAU;AACzD,UAAI,QAAQ;AAAM,kBAAU,UAAU,KAAK,GAAG,MAAM,IAAI;AACxD,WAAK,QAAQ,IAAI,MAAM,OAAO;AAAA,IAC/B,SAAS,GAAG;AACX,WAAK,QAAQ,IAAI,MAAM,gCAAgC,CAAC,GAAG;AAAA,IAC5D;AAEA,QAAI;AACH,UAAI,KAAK,UAAU,KAAK,QAAQ,OAAO,mBAAmB,SAAS,iBAAiB,MAAM;AACzF,aAAK,UACJ,KAAK,OAAO,UAAU,CAAC,UAAU;AAChC,gBAAM,SAAS,OAAkC;AACjD,gBAAM,SAAS,gBAAgB,YAAY;AAC3C,gBAAM,SAAS,cAAc,UAAU;AACvC,cAAI,MAAM;AACT,kBAAM,SAAS,QAAQ,IAAI;AAAA,UAC5B;AAEA,cAAI,KAAK,QAAQ;AAChB,iBAAK,OAAO,iBAAiB,GAAG;AAAA,UACjC;AAAA,QACD,CAAC;AAAA,MACH;AAAA,IACD,SAAS,GAAG;AACX,WAAK,QAAQ,IAAI,MAAM,uCAAuC,CAAC,GAAG;AAAA,IACnE;AAAA,EACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,cACC,OACA,UACA,SACA,MACO;AA/ET;AAgFE,QAAI,aAAa;AACjB,QAAI,KAAK,QAAQ,IAAI,UAAU,WAAW,KAAK,QAAQ,IAAI,UAAU,SAAS;AAC7E,mBAAa,IAAI,QAAQ,KAAK,OAAO;AAAA,IACtC;AACA,YAAQ,OAAO;AAAA,MACd,KAAK;AACJ,aAAK,QAAQ,IAAI,KAAK,UAAU;AAChC;AAAA,MACD,KAAK;AACJ,aAAK,QAAQ,IAAI,MAAM,UAAU;AACjC;AAAA,MACD;AACC,aAAK,QAAQ,IAAI,KAAK,UAAU;AAChC;AAAA,IACF;AACA,eAAK,WAAL,mBAAa,cAAc;AAAA,MAC1B,UAAU;AAAA,MACV,SAAS;AAAA;AAAA,MAET,MAAM;AAAA,IACP;AAAA,EACD;AAAA;AAED;",
  "names": []
}
